<div class="demo-container">

  <dx-data-grid
    [dataSource]="executionItems"
    keyExpr="Id"
    [repaintChangesOnly]="true"
    [showBorders]="true"
    (onSelectionChanged)="onSelectionChanged($event)">

    <dxo-editing
      [(changes)]="changes"
      mode="cell"
      [allowUpdating]="true"></dxo-editing>

    <dxi-column
      dataField="IsBatch"
      caption="IsBatch"
      alignment="center"
      ></dxi-column>

    <dxi-column
      id="movements"
      dataField="Movement"
      caption="Distribué"
      dataType="number"
      alignment="center"
      cellTemplate="movementsTemplate"
      [allowEditing]="true"
    ></dxi-column>

    <div *dxTemplate="let data of 'movementsTemplate'">
      <dx-text-box
        [disabled]="data.data.Disabled"
        (onValueChanged)="onValueMovementChange(data, $event)"
        [(value)]="data.value">
      </dx-text-box>
    </div>

    <dxi-column
      dataField="Lot"
      [showEditorAlways]="true"
      editCellTemplate="lotSelectionTemplate">

      <dxi-validation-rule
        message="lot requis pour ce produit"
        [validationCallback]="validateLot"
        type="custom">
      </dxi-validation-rule>

    </dxi-column>


    <div *dxTemplate="let data of 'lotSelectionTemplate'; let index">
      <dx-select-box
        [dataSource]="dataSource"
        displayExpr="LotNumber"
        valueExpr="LotNumber"
        [acceptCustomValue]="true"
        [(value)]="data.value"
        (onValueChanged)="setLotItem(data, $event)"
        (onCustomItemCreating)="onCustomItemCreating($event)"
        placeholder="ajouter où sélectionner un lot"
        [disabled]="data.data.Disabled"
      >
      </dx-select-box>
    </div>


    <dxo-toolbar>
      <dxi-item>
        <div *dxTemplate>
          <dx-button
            text="Validate DataGrid"
            stylingMode="outlined"
            (onClick)="validateVisibleRows()"
          ></dx-button>
        </div>
      </dxi-item>
    </dxo-toolbar>
  </dx-data-grid>


</div>
